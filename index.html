<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Five Elements Audit — The Excavation</title>
<link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;1,400;1,500&family=Cinzel:wght@400;600&family=Inconsolata:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root {
  --void: #050508;
  --deep: #08080F;
  --surface: #0E0E18;
  --surface2: #13131F;
  --code-green: #00FF94;
  --code-green-dim: rgba(0,255,148,0.12);
  --amber: #FFB347;
  --freq: #7B6FFF;
  --rose: #FF6B8A;
  --sky: #4FC3F7;
  --white: #F0EDE8;
  --white-dim: rgba(240,237,232,0.55);
  --white-ghost: rgba(240,237,232,0.1);
  --border: rgba(240,237,232,0.07);
  --border-bright: rgba(240,237,232,0.15);
}

*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}

body {
  background: var(--void);
  color: var(--white);
  font-family: 'EB Garamond', Georgia, serif;
  font-size: 18px;
  line-height: 1.7;
  overflow-x: hidden;
  min-height: 100vh;
}

/* Noise */
body::before {
  content:'';position:fixed;inset:0;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
  pointer-events:none;z-index:1000;opacity:0.35;
}

/* Scanning line */
body::after {
  content:'';position:fixed;top:-100%;left:0;right:0;height:1px;
  background:linear-gradient(to right,transparent,rgba(0,255,148,0.06),transparent);
  animation:scan 10s linear infinite;pointer-events:none;z-index:999;
}
@keyframes scan{to{top:200%;}}

/* Grid bg */
.grid-bg {
  position:fixed;inset:0;
  background-image:
    linear-gradient(rgba(0,255,148,0.025) 1px,transparent 1px),
    linear-gradient(90deg,rgba(0,255,148,0.025) 1px,transparent 1px);
  background-size:48px 48px;
  mask-image:radial-gradient(ellipse 100% 100% at 50% 0%,black 0%,transparent 70%);
  pointer-events:none;
}

/* Orbs */
.orb{position:fixed;border-radius:50%;filter:blur(120px);pointer-events:none;}
.orb1{width:500px;height:500px;background:radial-gradient(circle,rgba(0,255,148,0.05) 0%,transparent 70%);top:-100px;right:-100px;animation:d1 22s ease-in-out infinite;}
.orb2{width:350px;height:350px;background:radial-gradient(circle,rgba(123,111,255,0.06) 0%,transparent 70%);bottom:0;left:-50px;animation:d2 18s ease-in-out infinite;}
@keyframes d1{0%,100%{transform:translate(0,0)}50%{transform:translate(-30px,40px)}}
@keyframes d2{0%,100%{transform:translate(0,0)}50%{transform:translate(40px,-30px)}}

/* ── LAYOUT ── */
.wrap {
  max-width: 760px;
  margin: 0 auto;
  padding: 0 clamp(20px,6vw,60px);
  position: relative;
  z-index: 1;
}

/* ── HEADER ── */
header {
  padding: 60px 0 80px;
  text-align: center;
}

.eyebrow {
  font-family:'Inconsolata',monospace;
  font-size:10px;letter-spacing:0.45em;
  text-transform:uppercase;color:var(--code-green);
  opacity:0.7;margin-bottom:28px;display:block;
  animation:fadeUp 0.8s ease both;
}

header h1 {
  font-family:'Cinzel',serif;
  font-size:clamp(32px,6vw,64px);
  font-weight:400;line-height:1.1;
  color:var(--white);margin-bottom:20px;
  animation:fadeUp 0.8s ease 0.15s both;
}

header h1 em{
  font-family:'EB Garamond',serif;
  font-style:italic;color:var(--code-green);
  font-size:0.85em;
}

.header-sub {
  font-size:17px;font-style:italic;
  color:var(--white-dim);max-width:500px;
  margin:0 auto 12px;
  animation:fadeUp 0.8s ease 0.3s both;
}

.progress-wrap {
  margin-top:48px;
  animation:fadeUp 0.8s ease 0.45s both;
}

.progress-label {
  font-family:'Inconsolata',monospace;
  font-size:10px;letter-spacing:0.3em;
  text-transform:uppercase;color:rgba(240,237,232,0.3);
  margin-bottom:10px;display:flex;
  justify-content:space-between;align-items:center;
}

.progress-bar {
  height:1px;background:var(--border-bright);
  border-radius:1px;overflow:hidden;
}

.progress-fill {
  height:100%;background:var(--code-green);
  width:0%;transition:width 0.6s cubic-bezier(0.4,0,0.2,1);
  box-shadow:0 0 8px rgba(0,255,148,0.5);
}

/* ── LAYER NAV ── */
.layer-nav {
  display:flex;gap:8px;margin-bottom:60px;
  flex-wrap:wrap;justify-content:center;
  animation:fadeUp 0.8s ease 0.5s both;
}

.layer-pip {
  width:32px;height:3px;border-radius:2px;
  background:var(--border-bright);
  transition:background 0.4s, width 0.3s;
  cursor:default;
}

.layer-pip.active{background:var(--code-green);box-shadow:0 0 8px rgba(0,255,148,0.4);}
.layer-pip.done{background:rgba(0,255,148,0.35);}

/* ── QUESTION CARD ── */
.question-stage {
  min-height:60vh;
  display:flex;flex-direction:column;
  justify-content:center;
}

.layer-header {
  margin-bottom:48px;
  opacity:0;animation:fadeUp 0.6s ease forwards;
}

.layer-tag {
  font-family:'Inconsolata',monospace;
  font-size:10px;letter-spacing:0.4em;
  text-transform:uppercase;margin-bottom:10px;
  display:flex;align-items:center;gap:10px;
}

.layer-tag::after{
  content:'';flex:1;height:1px;
  background:linear-gradient(to right,currentColor,transparent);
  opacity:0.3;
}

.layer-name {
  font-family:'Cinzel',serif;
  font-size:clamp(22px,4vw,36px);
  font-weight:400;color:var(--white);
  line-height:1.2;
}

.layer-name .dim{opacity:0.35;font-size:0.6em;font-family:'Inconsolata',monospace;letter-spacing:0.1em;}

.question-block {
  opacity:0;transform:translateY(16px);
  animation:fadeUp 0.5s ease 0.15s forwards;
}

.q-number {
  font-family:'Inconsolata',monospace;
  font-size:10px;letter-spacing:0.35em;
  text-transform:uppercase;color:var(--white-dim);
  opacity:0.5;margin-bottom:16px;
}

.q-text {
  font-family:'EB Garamond',serif;
  font-size:clamp(20px,3vw,28px);
  font-style:italic;color:var(--white);
  line-height:1.4;margin-bottom:40px;
  max-width:600px;
}

/* Scale buttons */
.scale {
  display:flex;gap:10px;flex-wrap:wrap;
  margin-bottom:48px;
}

.scale-btn {
  display:flex;flex-direction:column;
  align-items:center;gap:8px;
  cursor:pointer;border:none;
  background:transparent;padding:0;
  transition:transform 0.2s;
}

.scale-btn:hover{transform:translateY(-3px);}

.scale-circle {
  width:52px;height:52px;border-radius:50%;
  border:1px solid var(--border-bright);
  background:var(--surface);
  display:flex;align-items:center;justify-content:center;
  font-family:'Cinzel',serif;font-size:18px;
  color:var(--white-dim);
  transition:all 0.25s ease;
  position:relative;overflow:hidden;
}

.scale-circle::before{
  content:'';position:absolute;inset:0;
  border-radius:50%;opacity:0;
  transition:opacity 0.25s;
}

.scale-btn:hover .scale-circle,
.scale-btn.selected .scale-circle {
  border-color:currentColor;
  color:var(--void);
}

.scale-btn.selected .scale-circle{
  transform:scale(1.1);
}

.scale-label {
  font-family:'Inconsolata',monospace;
  font-size:9px;letter-spacing:0.15em;
  text-transform:uppercase;
  color:rgba(240,237,232,0.3);
  text-align:center;max-width:52px;
  line-height:1.3;
}

/* Scale colors per value */
.scale-btn[data-val="1"] .scale-circle{--c:rgba(255,107,138,0.8);}
.scale-btn[data-val="2"] .scale-circle{--c:rgba(255,179,71,0.8);}
.scale-btn[data-val="3"] .scale-circle{--c:rgba(240,237,232,0.5);}
.scale-btn[data-val="4"] .scale-circle{--c:rgba(79,195,247,0.8);}
.scale-btn[data-val="5"] .scale-circle{--c:rgba(0,255,148,0.9);}

.scale-btn[data-val="1"]:hover .scale-circle,
.scale-btn[data-val="1"].selected .scale-circle{background:rgba(255,107,138,0.8);border-color:rgba(255,107,138,0.8);box-shadow:0 0 20px rgba(255,107,138,0.3);}
.scale-btn[data-val="2"]:hover .scale-circle,
.scale-btn[data-val="2"].selected .scale-circle{background:rgba(255,179,71,0.8);border-color:rgba(255,179,71,0.8);box-shadow:0 0 20px rgba(255,179,71,0.3);}
.scale-btn[data-val="3"]:hover .scale-circle,
.scale-btn[data-val="3"].selected .scale-circle{background:rgba(240,237,232,0.5);border-color:rgba(240,237,232,0.5);}
.scale-btn[data-val="4"]:hover .scale-circle,
.scale-btn[data-val="4"].selected .scale-circle{background:rgba(79,195,247,0.8);border-color:rgba(79,195,247,0.8);box-shadow:0 0 20px rgba(79,195,247,0.3);}
.scale-btn[data-val="5"]:hover .scale-circle,
.scale-btn[data-val="5"].selected .scale-circle{background:rgba(0,255,148,0.9);border-color:rgba(0,255,148,0.9);box-shadow:0 0 20px rgba(0,255,148,0.3);}

.next-btn {
  font-family:'Inconsolata',monospace;
  font-size:11px;letter-spacing:0.3em;
  text-transform:uppercase;
  background:transparent;
  border:1px solid rgba(0,255,148,0.3);
  color:var(--code-green);
  padding:14px 36px;border-radius:2px;
  cursor:pointer;
  transition:all 0.25s;
  opacity:0.3;pointer-events:none;
}

.next-btn.ready{opacity:1;pointer-events:all;}
.next-btn.ready:hover{background:var(--code-green-dim);border-color:var(--code-green);}

/* ── RADAR RESULTS ── */
#results{display:none;}

.results-header{
  text-align:center;padding:80px 0 60px;
  animation:fadeUp 0.8s ease both;
}

.results-eyebrow{
  font-family:'Inconsolata',monospace;
  font-size:10px;letter-spacing:0.45em;
  text-transform:uppercase;color:var(--code-green);
  opacity:0.7;margin-bottom:20px;display:block;
}

.results-title{
  font-family:'Cinzel',serif;
  font-size:clamp(28px,5vw,52px);
  font-weight:400;color:var(--white);
  line-height:1.15;margin-bottom:16px;
}

.results-sub{
  font-size:17px;font-style:italic;
  color:var(--white-dim);max-width:460px;
  margin:0 auto;
}

/* Radar chart */
.radar-wrap{
  display:flex;justify-content:center;
  margin:60px 0 40px;
  animation:fadeUp 0.8s ease 0.2s both;
}

canvas#radarCanvas{
  max-width:400px;width:100%;
  filter:drop-shadow(0 0 30px rgba(0,255,148,0.1));
}

/* Layer scores */
.scores-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;margin-bottom:60px;
  animation:fadeUp 0.8s ease 0.3s both;
}
@media(max-width:520px){.scores-grid{grid-template-columns:1fr;}}

.score-card{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:3px;padding:20px 24px;
  position:relative;overflow:hidden;
  transition:border-color 0.3s;
}

.score-card.deepest{
  border-color:rgba(255,107,138,0.3);
  background:linear-gradient(135deg,var(--surface) 0%,rgba(255,107,138,0.04) 100%);
}

.score-card.deepest::before{
  content:'DEEPEST LAYER';
  position:absolute;top:10px;right:12px;
  font-family:'Inconsolata',monospace;
  font-size:8px;letter-spacing:0.25em;
  color:rgba(255,107,138,0.6);
}

.score-card.clearest{
  border-color:rgba(0,255,148,0.25);
  background:linear-gradient(135deg,var(--surface) 0%,rgba(0,255,148,0.03) 100%);
}

.score-card.clearest::before{
  content:'CLEAREST SIGNAL';
  position:absolute;top:10px;right:12px;
  font-family:'Inconsolata',monospace;
  font-size:8px;letter-spacing:0.25em;
  color:rgba(0,255,148,0.5);
}

.score-layer-name{
  font-family:'Cinzel',serif;
  font-size:13px;letter-spacing:0.05em;
  color:var(--white);margin-bottom:12px;
  display:flex;align-items:center;gap:8px;
}

.score-bar-wrap{
  height:3px;background:var(--border);
  border-radius:2px;overflow:hidden;margin-bottom:8px;
}

.score-bar-fill{
  height:100%;border-radius:2px;
  transition:width 1s cubic-bezier(0.4,0,0.2,1) 0.5s;
  width:0%;
}

.score-pct{
  font-family:'Inconsolata',monospace;
  font-size:11px;color:var(--white-dim);
  opacity:0.5;
}

/* Insight block */
.insight-block{
  background:var(--surface2);
  border:1px solid var(--border);
  border-left:2px solid var(--rose);
  border-radius:3px;
  padding:36px 40px;
  margin:20px 0 60px;
  animation:fadeUp 0.8s ease 0.4s both;
}

.insight-tag{
  font-family:'Inconsolata',monospace;
  font-size:9px;letter-spacing:0.4em;
  text-transform:uppercase;color:var(--rose);
  margin-bottom:16px;display:block;opacity:0.8;
}

.insight-text{
  font-size:19px;font-style:italic;
  color:var(--white);line-height:1.65;
}

/* Prescription */
.prescription{
  background:var(--surface);
  border:1px solid rgba(0,255,148,0.15);
  border-radius:3px;
  padding:36px 40px;
  margin-bottom:60px;
  animation:fadeUp 0.8s ease 0.5s both;
  position:relative;overflow:hidden;
}

.prescription::before{
  content:'';position:absolute;
  top:0;left:0;right:0;height:1px;
  background:linear-gradient(to right,transparent,var(--code-green),transparent);
}

.rx-tag{
  font-family:'Inconsolata',monospace;
  font-size:9px;letter-spacing:0.4em;
  text-transform:uppercase;color:var(--code-green);
  margin-bottom:20px;display:block;opacity:0.7;
}

.rx-title{
  font-family:'Cinzel',serif;
  font-size:clamp(18px,3vw,26px);
  color:var(--white);margin-bottom:16px;
  line-height:1.3;
}

.rx-body{
  font-size:17px;color:var(--white-dim);
  line-height:1.7;margin-bottom:20px;
}

.rx-steps{
  display:flex;flex-direction:column;gap:10px;
  margin-top:20px;
}

.rx-step{
  display:flex;gap:16px;align-items:flex-start;
  padding:14px 16px;
  background:rgba(0,255,148,0.03);
  border:1px solid rgba(0,255,148,0.08);
  border-radius:2px;
}

.rx-step-num{
  font-family:'Inconsolata',monospace;
  font-size:10px;color:var(--code-green);
  opacity:0.6;min-width:20px;padding-top:2px;
}

.rx-step-text{
  font-size:15px;color:var(--white-dim);
  line-height:1.5;
}

/* CTA */
.cta-block{
  background:linear-gradient(135deg,var(--surface) 0%,rgba(0,255,148,0.03) 100%);
  border:1px solid rgba(0,255,148,0.15);
  border-radius:3px;padding:52px 48px;
  text-align:center;margin-bottom:100px;
  animation:fadeUp 0.8s ease 0.6s both;
  position:relative;overflow:hidden;
}

.cta-block::before{
  content:'';position:absolute;
  inset:0;background:radial-gradient(ellipse 60% 50% at 50% 0%,rgba(0,255,148,0.04) 0%,transparent 70%);
}

.cta-title{
  font-family:'Cinzel',serif;
  font-size:clamp(22px,3.5vw,36px);
  color:var(--white);margin-bottom:16px;
  position:relative;
}

.cta-body{
  font-size:17px;font-style:italic;
  color:var(--white-dim);max-width:440px;
  margin:0 auto 36px;line-height:1.6;
  position:relative;
}

.capture-form{display:flex;gap:0;max-width:440px;margin:0 auto 12px;position:relative;}

.capture-form input[type="email"]{
  font-family:'EB Garamond',serif;font-size:16px;
  background:rgba(0,0,0,0.35);
  border:1px solid rgba(0,255,148,0.2);
  border-right:none;border-radius:2px 0 0 2px;
  padding:14px 18px;color:var(--white);
  flex:1;outline:none;
  transition:border-color 0.3s;
}

.capture-form input:focus{border-color:var(--code-green);}
.capture-form input::placeholder{color:rgba(240,237,232,0.25);font-style:italic;}

.capture-form button{
  font-family:'Inconsolata',monospace;
  font-size:10px;letter-spacing:0.25em;
  text-transform:uppercase;
  background:var(--code-green);color:var(--void);
  border:none;padding:14px 22px;
  border-radius:0 2px 2px 0;
  cursor:pointer;font-weight:500;
  transition:opacity 0.2s;white-space:nowrap;
}

.capture-form button:hover{opacity:0.85;}

.capture-note{
  font-family:'Inconsolata',monospace;
  font-size:9px;letter-spacing:0.2em;
  color:rgba(240,237,232,0.2);
  text-transform:uppercase;position:relative;
}

.success-msg{
  display:none;font-family:'EB Garamond',serif;
  font-size:20px;font-style:italic;
  color:var(--code-green);position:relative;
}

@media(max-width:520px){
  .capture-form{flex-direction:column;}
  .capture-form input{border-right:1px solid rgba(0,255,148,0.2);border-bottom:none;border-radius:2px 2px 0 0;}
  .capture-form button{border-radius:0 0 2px 2px;}
  .insight-block,.prescription,.cta-block{padding:28px 24px;}
}

@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>

<div class="grid-bg"></div>
<div class="orb orb1"></div>
<div class="orb orb2"></div>

<div class="wrap">

  <!-- HEADER -->
  <header>
    <span class="eyebrow">The Excavation — Free Assessment</span>
    <h1>The <em>Five Elements</em> Audit</h1>
    <p class="header-sub">Discover which element you're most buried in — and where to begin the Work.</p>

    <div class="progress-wrap">
      <div class="progress-label">
        <span id="progressText">Element 1 of 5</span>
        <span id="progressPct">0%</span>
      </div>
      <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    </div>
  </header>

  <!-- LAYER PIPS -->
  <div class="layer-nav" id="layerNav"></div>

  <!-- QUESTION STAGE -->
  <div id="questionStage" class="question-stage"></div>

  <!-- RESULTS -->
  <div id="results">
    <div class="results-header">
      <span class="results-eyebrow">// elements_map.decoded()</span>
      <h2 class="results-title">Your Elemental Map</h2>
      <p class="results-sub">Here's exactly where you're buried — and where the signal is already breaking through.</p>
    </div>

    <div class="radar-wrap">
      <canvas id="radarCanvas" width="400" height="400"></canvas>
    </div>

    <div class="scores-grid" id="scoresGrid"></div>

    <div class="insight-block">
      <span class="insight-tag">// primary_diagnosis</span>
      <p class="insight-text" id="insightText"></p>
    </div>

    <div class="prescription" id="prescriptionBlock">
      <span class="rx-tag">// excavation_protocol.txt</span>
      <h3 class="rx-title" id="rxTitle"></h3>
      <p class="rx-body" id="rxBody"></p>
      <div class="rx-steps" id="rxSteps"></div>
    </div>

    <div class="cta-block">
      <h3 class="cta-title">Receive Your Full Excavation Protocol</h3>
      <p class="cta-body">Each week we transmit one layer — decoded, with practical tools you can use immediately. No noise. Just signal.</p>
      <div id="ctaForm">
        <div class="capture-form">
          <input type="email" id="ctaEmail" placeholder="Your email address">
          <button onclick="submitAudit()">Send My Protocol →</button>
        </div>
        <p class="capture-note">Free · No ads · Unsubscribe anytime</p>
      </div>
      <p class="success-msg" id="ctaSuccess">✦ Transmission confirmed. Your protocol arrives soon.</p>
    </div>
  </div>

</div><!-- /wrap -->

<script>
// ── DATA ──────────────────────────────────────────────────
const LAYERS = [
  {
    id: 'financial',
    name: 'Water — Currency & Flow',
    shortName: 'Water',
    tag: '// element_01 — water',
    color: '#4A9ECC',
    colorRGB: '74,158,204',
    emoji: '≋',
    questions: [
      'The way I relate to money feels like honest exchange — I trust the flow of value in my life rather than feeling controlled by systems I don\'t understand.',
      'My emotional relationships feel genuinely nourishing — I can receive trust, care, and connection without immediately converting them into obligation or debt.',
      'I feel a real relationship with what sustains me — where my food comes from, what my labor produces, what I am actually participating in when I spend or save.'
    ]
  },
  {
    id: 'body',
    name: 'Earth — Body & Living Soil',
    shortName: 'Earth',
    tag: '// element_02 — earth',
    color: '#C49A5A',
    colorRGB: '196,154,90',
    emoji: '◉',
    questions: [
      'My body feels like a clear instrument I can hear — not a source of noise, chronic burden, or confusion I manage from a distance.',
      'My physical environment — my home, my possessions, what surrounds me daily — feels like an extension of my nervous system rather than something that owns me.',
      'I have a real relationship with the land and the food it produces — I am moving toward the body and the earth being understood as one living system.'
    ]
  },
  {
    id: 'frequency',
    name: 'Air — Thought, Sound & Intention',
    shortName: 'Air',
    tag: '// element_03 — air',
    color: '#9ECFB8',
    colorRGB: '158,207,184',
    emoji: '∿',
    questions: [
      'My nervous system feels regulated — I can move between activation and genuine stillness, and my breath reflects that rather than fighting against it.',
      'The way I communicate — what I say, how I say it, whether it actually transmits what is true in me — feels aligned rather than managed.',
      'I am directing my attention with intention — the tools I use amplify my purpose rather than harvesting my hours for someone else\'s.'
    ]
  },
  {
    id: 'attention',
    name: 'Fire — Transformation & Integration',
    shortName: 'Fire',
    tag: '// element_04 — fire',
    color: '#CC6A4A',
    colorRGB: '204,106,74',
    emoji: '△',
    questions: [
      'When things fall apart in my life — patterns breaking, identities dissolving, heat arriving — I can recognize it as transformation rather than only as loss.',
      'I have access to both the capacity to move with full directed intention and the capacity to stop completely and receive — and I am learning when each is required.',
      'The emotional material I carry — the unresolved, the inherited, the things the body has been speaking while the mind looked away — I am in genuine dialogue with it.'
    ]
  },
  {
    id: 'consciousness',
    name: 'Void — Presence & the Ground',
    shortName: 'Void',
    tag: '// element_05 — void',
    color: '#C9913D',
    colorRGB: '201,145,61',
    emoji: '◈',
    questions: [
      'I can be genuinely alone with silence — not anxious, not reaching for stimulation — and find that the silence contains something rather than threatening something.',
      'I have a practice that strips away enough noise for me to hear what was always underneath — and I return to it even when everything in the system is designed to keep me away from it.',
      'I feel that I know who I am beneath all the layers — and that the person underneath is not a problem to be solved but a signal to be inhabited.'
    ]
  }
];

const PRESCRIPTIONS = {
  financial: {
    title: 'Begin With Water — Let the Currency Flow Honestly',
    body: 'Water is the element of nourishment, trust, and honest exchange — and the financial burial is a symptom of a deeper relational one. When genuine trust between people was replaced with institutional guarantees, money lost the quality that makes it feel alive in your hands. Your excavation here does not begin with buying Bitcoin. It begins with understanding what value actually is, what honest exchange actually feels like, and what it means to let yourself be genuinely nourished rather than just fed.',
    steps: [
      'Read Satoshi\'s original white paper. All 9 pages. Slowly. It is a philosophical document disguised as a technical one.',
      'Open one self-custody wallet. Move a small amount. Feel what it means to hold keys no institution can touch.',
      'Fast for 24 hours and spend the time studying the history of money. The clarity of the fast + the clarity of the knowledge compounds.',
      'Join the next Hidden In The Codes transmission on the financial layer — we decode one piece per week.'
    ]
  },
  body: {
    title: 'Begin With Earth — Return the Body to Its Natural State',
    body: 'The body has been speaking to you your entire life. The earth excavation follows a clear progression — you cannot build on cluttered land. It begins with the body itself, moves to the home, releases material attachments, and ultimately points toward the land, the community, and the sovereign relationship with what sustains you. Begin where you are. But know the direction you are moving.',
    steps: [
      'Do your first intentional 24-hour fast. Water only. This is not about weight. It is about hearing what speaks when the noise stops.',
      'On hour 18, go outside. Walk slowly. Notice what becomes audible in your body that you couldn\'t hear before.',
      'On breaking your fast, eat one whole, unprocessed meal. Feel the difference between feeding the signal vs. feeding the system.',
      'Journal what emerged. The body\'s first transmissions after silence are usually the most important ones.'
    ]
  },
  frequency: {
    title: 'Begin With Air — Restore the Frequency of Your Own Field',
    body: 'Air is the element of sound, breath, thought, and communication — and the most immediate air excavation tool is the one you were born with. Your voice, directed intentionally at your own nervous system, produces effects that no external sound can replicate at the same depth. The air excavation also includes reclaiming the medium of your attention and learning to communicate from the place that is actually true rather than the place that manages.',
    steps: [
      'Find a 432hz sound bath recording — 30 to 60 minutes. Lie down. Headphones. Eyes closed. No agenda.',
      'Notice the moment your nervous system shifts. It will happen. When it does, understand: that is your baseline. That is what buried feels like vs. what clear feels like.',
      'Begin a practice of sound before screens each morning — even 5 minutes of coherent frequency before the algorithm gets your nervous system.',
      'Seek a live sound bath if you can. The resonance in a physical room is categorically different from recordings.'
    ]
  },
  attention: {
    title: 'Begin With Fire — Reclaim the Hours, Forge the Self',
    body: 'Fire is the transformative element — and the thing that feels like everything falling apart is usually fire doing exactly what it is for. The fire excavation is not about managing your emotions or optimizing your time. It is about going into the interior of what has been avoided, letting the heat of genuine encounter with your own unresolved material do its work, and discovering what remains when it does. The masculine and feminine functions within you are both asking to be met here.',
    steps: [
      'For one week: no phone for the first 60 minutes after waking. Non-negotiable. This is where the buried self has its best chance to speak.',
      'Install a time-tracking app. Look at your actual screen time without judgment. Then ask: does this reflect who I am?',
      'Pick one AI tool — Claude is a good start — and spend one hour learning to use it intentionally. Let it take the work that was stealing your signal hours.',
      'Define your signal hours: the 2-3 hours per day when your thinking is clearest. Protect them like sovereign territory.'
    ]
  },
  consciousness: {
    title: 'Begin With the Void — Everything Buried Can Be Found From Here',
    body: 'The void is the ground state that all the other elements arise from and return to. When it is the most buried, the other four cannot fully function — because presence is the medium through which every other excavation reaches its depth. This is not the beginning of the work. It is the depth beneath all the other beginnings. The fact that you are here means the signal was never lost. It was covered. And you are already uncovering it.',
    steps: [
      'Begin a daily practice of intentional silence — not guided meditation, not binaural beats yet. Just silence. 10 minutes. Morning. No phone nearby.',
      'Ask yourself one question each morning and write without editing: "What do I know today that I am pretending not to know?"',
      'Combine one 24-hour fast with one extended silence practice. The convergence of metabolic quiet and mental quiet creates a specific kind of clarity that very few people ever experience.',
      'Know that you were always there. The signal was never lost. It was covered. And you are already uncovering it — or you would not be here.'
    ]
  }
};

// ── STATE ──────────────────────────────────────────────────
let currentLayer = 0;
let currentQ = 0;
let answers = {}; // layerId -> [scores]
let allScores = {}; // layerId -> avg (0-1)

// ── INIT ──────────────────────────────────────────────────
function init() {
  buildLayerNav();
  renderQuestion();
}

function buildLayerNav() {
  const nav = document.getElementById('layerNav');
  nav.innerHTML = '';
  LAYERS.forEach((l, i) => {
    const pip = document.createElement('div');
    pip.className = 'layer-pip' + (i === 0 ? ' active' : '');
    pip.id = 'pip-' + i;
    nav.appendChild(pip);
  });
}

function updateNav() {
  LAYERS.forEach((l, i) => {
    const pip = document.getElementById('pip-' + i);
    if (!pip) return;
    pip.className = 'layer-pip';
    if (i < currentLayer) pip.classList.add('done');
    else if (i === currentLayer) pip.classList.add('active');
  });
}

function updateProgress() {
  const totalQ = LAYERS.length * 3;
  const doneQ = currentLayer * 3 + currentQ;
  const pct = Math.round((doneQ / totalQ) * 100);
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressPct').textContent = pct + '%';
  const layerNum = Math.min(currentLayer + 1, LAYERS.length);
  document.getElementById('progressText').textContent = `Element ${layerNum} of ${LAYERS.length}`;
}

// ── RENDER QUESTION ──────────────────────────────────────
function renderQuestion() {
  updateNav();
  updateProgress();

  const stage = document.getElementById('questionStage');
  const layer = LAYERS[currentLayer];
  const qText = layer.questions[currentQ];
  const qNum = currentLayer * 3 + currentQ + 1;
  const totalQ = LAYERS.length * 3;
  const isSelected = answers[layer.id] && answers[layer.id][currentQ] !== undefined;
  const selectedVal = isSelected ? answers[layer.id][currentQ] : null;

  const scaleLabels = ['Deeply buried','Mostly covered','Somewhere between','Breaking through','Clear signal'];

  stage.innerHTML = `
    <div class="layer-header">
      <div class="layer-tag" style="color:${layer.color}">${layer.tag}</div>
      <h2 class="layer-name">${layer.name} <span class="dim">Q${currentQ + 1}/3</span></h2>
    </div>
    <div class="question-block">
      <div class="q-number">// question ${qNum} of ${totalQ}</div>
      <p class="q-text">"${qText}"</p>
      <div class="scale">
        ${[1,2,3,4,5].map((v,i) => `
          <button class="scale-btn ${selectedVal === v ? 'selected' : ''}" data-val="${v}" onclick="selectAnswer(${v})" style="color:${layer.color}">
            <div class="scale-circle">${v}</div>
            <div class="scale-label">${scaleLabels[i]}</div>
          </button>
        `).join('')}
      </div>
      <button class="next-btn ${selectedVal !== null ? 'ready' : ''}" id="nextBtn" onclick="advance()">
        ${isLastQuestion() ? 'Reveal My Signal Map →' : 'Next →'}
      </button>
    </div>
  `;

  // Re-animate
  stage.querySelector('.layer-header').style.animation = 'none';
  stage.querySelector('.question-block').style.animation = 'none';
  void stage.offsetWidth;
  stage.querySelector('.layer-header').style.animation = '';
  stage.querySelector('.question-block').style.animation = '';
}

function isLastQuestion() {
  return currentLayer === LAYERS.length - 1 && currentQ === 2;
}

function selectAnswer(val) {
  const layer = LAYERS[currentLayer];
  if (!answers[layer.id]) answers[layer.id] = [];
  answers[layer.id][currentQ] = val;

  document.querySelectorAll('.scale-btn').forEach(btn => {
    btn.classList.toggle('selected', parseInt(btn.dataset.val) === val);
  });

  const nextBtn = document.getElementById('nextBtn');
  if (nextBtn) nextBtn.classList.add('ready');
}

function advance() {
  const layer = LAYERS[currentLayer];
  if (!answers[layer.id] || answers[layer.id][currentQ] === undefined) return;

  if (currentQ < 2) {
    currentQ++;
    renderQuestion();
  } else if (currentLayer < LAYERS.length - 1) {
    currentLayer++;
    currentQ = 0;
    renderQuestion();
  } else {
    showResults();
  }
}

// ── RESULTS ──────────────────────────────────────────────
function showResults() {
  // Calculate scores
  LAYERS.forEach(l => {
    const scores = answers[l.id] || [3,3,3];
    const avg = scores.reduce((a,b) => a + b, 0) / 3;
    allScores[l.id] = avg; // 1-5
  });

  document.getElementById('questionStage').style.display = 'none';
  document.getElementById('layerNav').style.display = 'none';
  document.getElementById('results').style.display = 'block';
  document.querySelector('.progress-wrap').style.display = 'none';

  // Update progress to 100%
  document.getElementById('progressFill').style.width = '100%';

  drawRadar();
  buildScoreCards();
  buildInsight();
  buildPrescription();
  window.scrollTo({top: 0, behavior: 'smooth'});
}

// ── RADAR CHART ──────────────────────────────────────────
function drawRadar() {
  const canvas = document.getElementById('radarCanvas');
  const ctx = canvas.getContext('2d');
  const W = canvas.width, H = canvas.height;
  const cx = W/2, cy = H/2;
  const R = Math.min(W,H) * 0.38;
  const n = LAYERS.length;
  const angles = LAYERS.map((_,i) => (Math.PI * 2 * i / n) - Math.PI/2);

  ctx.clearRect(0,0,W,H);

  // Background webs
  for (let ring = 1; ring <= 5; ring++) {
    ctx.beginPath();
    angles.forEach((a,i) => {
      const r = R * ring / 5;
      const x = cx + r * Math.cos(a);
      const y = cy + r * Math.sin(a);
      i === 0 ? ctx.moveTo(x,y) : ctx.lineTo(x,y);
    });
    ctx.closePath();
    ctx.strokeStyle = ring === 5 ? 'rgba(240,237,232,0.1)' : 'rgba(240,237,232,0.04)';
    ctx.lineWidth = 1;
    ctx.stroke();
  }

  // Axis lines
  angles.forEach(a => {
    ctx.beginPath();
    ctx.moveTo(cx, cy);
    ctx.lineTo(cx + R * Math.cos(a), cy + R * Math.sin(a));
    ctx.strokeStyle = 'rgba(240,237,232,0.06)';
    ctx.lineWidth = 1;
    ctx.stroke();
  });

  // Data polygon
  const dataPoints = LAYERS.map((l,i) => {
    const score = allScores[l.id];
    const r = R * score / 5;
    return {
      x: cx + r * Math.cos(angles[i]),
      y: cy + r * Math.sin(angles[i]),
      color: l.color,
      colorRGB: l.colorRGB
    };
  });

  // Fill
  const gradient = ctx.createRadialGradient(cx,cy,0,cx,cy,R);
  gradient.addColorStop(0,'rgba(0,255,148,0.15)');
  gradient.addColorStop(1,'rgba(0,255,148,0.01)');
  ctx.beginPath();
  dataPoints.forEach((p,i) => i === 0 ? ctx.moveTo(p.x,p.y) : ctx.lineTo(p.x,p.y));
  ctx.closePath();
  ctx.fillStyle = gradient;
  ctx.fill();

  // Stroke
  ctx.beginPath();
  dataPoints.forEach((p,i) => i === 0 ? ctx.moveTo(p.x,p.y) : ctx.lineTo(p.x,p.y));
  ctx.closePath();
  ctx.strokeStyle = 'rgba(0,255,148,0.5)';
  ctx.lineWidth = 1.5;
  ctx.stroke();

  // Dots + glow per layer color
  dataPoints.forEach((p,i) => {
    const score = allScores[LAYERS[i].id];
    // Glow
    const glowGrad = ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,18);
    glowGrad.addColorStop(0,`rgba(${LAYERS[i].colorRGB},0.3)`);
    glowGrad.addColorStop(1,'transparent');
    ctx.beginPath();
    ctx.arc(p.x,p.y,18,0,Math.PI*2);
    ctx.fillStyle = glowGrad;
    ctx.fill();
    // Dot
    ctx.beginPath();
    ctx.arc(p.x,p.y,5,0,Math.PI*2);
    ctx.fillStyle = LAYERS[i].color;
    ctx.fill();
  });

  // Labels
  angles.forEach((a,i) => {
    const layer = LAYERS[i];
    const score = allScores[layer.id];
    const labelR = R + 36;
    const x = cx + labelR * Math.cos(a);
    const y = cy + labelR * Math.sin(a);

    ctx.font = '600 11px Cinzel, serif';
    ctx.fillStyle = score < 2.5 ? layer.color : 'rgba(240,237,232,0.5)';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(layer.shortName.toUpperCase(), x, y);

    // Score
    ctx.font = '300 10px Inconsolata, monospace';
    ctx.fillStyle = 'rgba(240,237,232,0.3)';
    ctx.fillText(score.toFixed(1) + '/5', x, y + 14);
  });
}

// ── SCORE CARDS ──────────────────────────────────────────
function buildScoreCards() {
  const grid = document.getElementById('scoresGrid');
  grid.innerHTML = '';

  const sorted = [...LAYERS].sort((a,b) => allScores[a.id] - allScores[b.id]);
  const deepestId = sorted[0].id;
  const clearestId = sorted[sorted.length-1].id;

  LAYERS.forEach(layer => {
    const score = allScores[layer.id];
    const pct = Math.round((score/5)*100);
    const isDeepest = layer.id === deepestId;
    const isClearest = layer.id === clearestId;

    const card = document.createElement('div');
    card.className = 'score-card' + (isDeepest?' deepest':'') + (isClearest?' clearest':'');
    card.innerHTML = `
      <div class="score-layer-name">
        <span style="color:${layer.color};font-size:16px">${layer.emoji}</span>
        ${layer.name}
      </div>
      <div class="score-bar-wrap">
        <div class="score-bar-fill" style="background:${layer.color};width:0%" data-pct="${pct}"></div>
      </div>
      <div class="score-pct">${pct}% signal clarity</div>
    `;
    grid.appendChild(card);
  });

  // Animate bars
  setTimeout(() => {
    document.querySelectorAll('.score-bar-fill').forEach(bar => {
      bar.style.width = bar.dataset.pct + '%';
    });
  }, 300);
}

// ── INSIGHT ──────────────────────────────────────────────
function buildInsight() {
  const sorted = [...LAYERS].sort((a,b) => allScores[a.id] - allScores[b.id]);
  const deepest = sorted[0];
  const clearest = sorted[sorted.length-1];
  const deepScore = allScores[deepest.id];
  const clearScore = allScores[clearest.id];

  const insights = {
    financial: `Your deepest burial is in the money layer — which means a significant portion of your cognitive and creative energy is quietly consumed by financial anxiety, dependency, or a system you don't fully understand but are fully inside. This is not a failure of discipline. It is the designed outcome of a system that benefits from your confusion. The excavation here is not just financial. When the money layer clears, the mental bandwidth that returns is often stunning.`,
    body: `Your body has been carrying the loudest layer of noise. The metabolic, inflammatory, or habitual weight of the modern food environment has been sitting on top of every other signal you've tried to receive. This is the most physical burial — which means it responds to the most physical intervention. Fasting is not a diet. It is the oldest technology for clearing this layer, used by every wisdom tradition that understood what the body sounds like when it goes quiet.`,
    frequency: `Your nervous system is your most buried layer — which means the environment you live in has been detuning you, possibly for years. This is the layer most people don't even know exists as a layer. They just feel vaguely overwhelmed, reactive, or disconnected and attribute it to personality or circumstance. It is neither. It is frequency. And frequency, unlike almost everything else in this work, can shift in a single session with the right sound.`,
    attention: `Your attention is the most compromised layer — and this one has a compounding effect on everything else. When the algorithm owns your mornings, your financial thinking is reactive rather than sovereign. When your best hours go to a screen, your body never gets the fasting or movement it needs. When your attention is fragmented, the inner signal can't get a word in. Reclaiming your attention is not a productivity hack. It is the prerequisite for every other excavation to work.`,
    consciousness: `Your deepest burial is at the root — the inner signal layer. This is the rarest form of the burial because it means the external tools (money, body, frequency, technology) may actually be in relatively better shape, but the connection to your own knowing has been the most suppressed. Often this comes from a lifetime of being told not to trust what you feel. Of being right about something and having that rightness dismissed until you learned to dismiss it yourself. You stopped. You are here. That is the first signal breaking through.`
  };

  const deepPct = Math.round((deepScore/5)*100);
  const clearPct = Math.round((clearScore/5)*100);

  document.getElementById('insightText').innerHTML =
    insights[deepest.id] +
    `<br><br>Your clearest signal is already coming through in the <strong style="color:${clearest.color}">${clearest.name}</strong> layer at ${clearPct}% clarity — this is your foundation. Build from here.`;
}

// ── PRESCRIPTION ──────────────────────────────────────────
function buildPrescription() {
  const sorted = [...LAYERS].sort((a,b) => allScores[a.id] - allScores[b.id]);
  const deepest = sorted[0];
  const rx = PRESCRIPTIONS[deepest.id];

  document.getElementById('rxTitle').textContent = rx.title;
  document.getElementById('rxBody').textContent = rx.body;

  const stepsEl = document.getElementById('rxSteps');
  stepsEl.innerHTML = rx.steps.map((s,i) => `
    <div class="rx-step">
      <span class="rx-step-num">0${i+1}</span>
      <span class="rx-step-text">${s}</span>
    </div>
  `).join('');
}

// ── EMAIL CAPTURE ──────────────────────────────────────────
async function submitAudit() {
  const email = document.getElementById('ctaEmail').value.trim();
  if (!email || !email.includes('@')) {
    document.getElementById('ctaEmail').style.borderColor = 'rgba(255,107,138,0.5)';
    return;
  }

  // Build score summary
  const scoreSummary = LAYERS.map(l =>
    `${l.name}: ${allScores[l.id].toFixed(1)}/5`
  ).join(' | ');

  const sorted = [...LAYERS].sort((a,b) => allScores[a.id] - allScores[b.id]);
  const deepestName = sorted[0].name;

  try {
    await fetch('https://formspree.io/f/xnjbwwkj', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        email,
        source: 'Five Elements Audit',
        deepest_layer: deepestName,
        scores: scoreSummary,
        _subject: `⛏ Five Elements Audit: Deepest Element — ${deepestName}`
      })
    });
  } catch(e) {}

  document.getElementById('ctaForm').style.display = 'none';
  document.getElementById('ctaSuccess').style.display = 'block';
}

// ── START ──────────────────────────────────────────────────
init();
</script>
</body>
</html>
